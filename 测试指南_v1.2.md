# 🧪 测试指南 v1.2

## ⚠️ 重要：清除浏览器缓存

**在测试前必须清除缓存！**

### 如何清除缓存

#### Chrome / Edge
1. 按 `Cmd + Shift + Delete` (Mac) 或 `Ctrl + Shift + Delete` (Windows)
2. 选择"缓存的图片和文件"
3. 点击"清除数据"

#### 或者强制刷新
- Mac: `Cmd + Shift + R`
- Windows: `Ctrl + Shift + R`

---

## 🎯 测试步骤

### 测试1：物种选择（2024版新规则）

1. **访问**：http://localhost:3000
2. **点击**："创建新角色"
3. **跳过**：基本信息和职业选择
4. **到达**：物种选择页面

#### 验证点
✅ 应该看到 **10个物种**（不是9个）
✅ 每个物种显示：
  - 体型（如"中型"或"中型或小型（可选）"）
  - 速度（30尺或35尺）
  - 特质描述（对象格式，如"黑暗视觉: 60尺黑暗视觉"）

#### 特别检查
- **巨人裔** 和 **兽人** 应该出现（2024新增）
- 物种描述应该是详细的（不只是简单的一句话）
- **不应该**有"属性加值"信息（2024版移除了）

---

### 测试2：物种特性选择

#### 2.1 测试人类
1. 选择"人类"
2. 应该出现子页面
3. **选择**：
   - 体型：中型或小型
   - 技能：任意一项

✅ 选择完成后显示绿色提示

#### 2.2 测试精灵
1. 选择"精灵"
2. 应该出现子页面
3. **选择**：
   - 血统：卓尔/高等精灵/木精灵
   - 技能：洞悉/察觉/生存

✅ 选择完成后显示绿色提示

#### 2.3 测试矮人（无需选择）
1. 选择"矮人"
2. 应该直接显示"✓ 物种设置完成！"
3. 不需要额外选择

---

### 测试3：购点法（修复验证）

1. 到达"分配属性"页面
2. 点击 **"购点法 (27点)"** 标签
3. **验证**：
   - 所有属性从8开始 ✅
   - 显示"已用点数: 0 / 27" ✅
   - 显示成本表 ✅
   - 可以点击 + 和 - 按钮 ✅
   - 点击 + 时，点数正确减少 ✅
   - 不能低于8或高于15 ✅

#### 如果报错
**检查浏览器控制台（F12）**，复制错误信息

---

### 测试4：背景属性加值（2024新规则）

1. 选择任意背景（如"士兵"）
2. 看到固定的2个技能
3. **应该出现橙色框："分配属性加值"**
4. **验证**：
   - 显示"+3点可分配"
   - 显示3个可选属性（如士兵：力量/体质/魅力）
   - 有"切换模式"按钮
   - **+2/+1模式**：
     - 第一个属性最多+2
     - 第二个属性最多+1
     - 总共3点
   - **+1/+1/+1模式**：
     - 3个属性各+1
   - 完成后显示绿色"✓"

---

### 测试5：完整流程

#### 创建一个人类战士

1. **基本信息**：
   - 名字：随意
   - 等级：1
   - 阵营：任意

2. **职业**：战士
   - 选择2个技能
   - 选择战斗风格（如"防御"）

3. **物种**：人类
   - 体型：中型
   - 技能：察觉

4. **背景**：士兵
   - 自动技能：竞技、威吓
   - **属性加值**：力量+2、体质+1

5. **属性**：购点法
   - 力量：15（花费9点）
   - 敏捷：10（花费2点）
   - 体质：14（花费7点）
   - 智力：10（花费2点）
   - 感知：12（花费4点）
   - 魅力：10（花费2点）
   - 总计：26点（还剩1点）

6. **技能总览**：查看

7. **装备**：选择

8. **完成**：
   - 查看审核页面
   - **验证最终属性**：
     - 力量：17 (15+2) ← 应该显示这种格式
     - 体质：15 (14+1)
     - 其他：无加值

9. **导出PDF**：
   - 点击"导出 PDF"
   - 检查PDF格式
   - 验证属性显示正确

---

## 🐛 常见问题

### 问题1：物种特质显示为 [object Object]
**原因**：浏览器缓存了旧数据
**解决**：清除缓存并强制刷新

### 问题2：购点法报错
**可能原因**：
- 之前用标准数组分配了超过15的值
- 浏览器缓存

**解决步骤**：
1. 清除浏览器缓存
2. 刷新页面
3. 创建**新角色**
4. 直接选择购点法（不要先用其他方法）

### 问题3：背景属性加值不显示
**原因**：可能是组件未加载
**解决**：
1. 刷新页面
2. 确认背景选择完成
3. 应该自动显示橙色框

### 问题4：物种只有9个
**原因**：数据未更新
**解决**：
1. 停止服务器（终端按 Ctrl+C）
2. 重新运行：`npm run dev`
3. 清除浏览器缓存

---

## 📊 预期结果总结

| 测试项 | 预期结果 |
|--------|---------|
| 物种数量 | 10个（含巨人裔、兽人）|
| 物种特质 | 对象格式，详细描述 |
| 物种属性加值 | ❌ 无（2024版移除）|
| 背景属性加值 | ✅ +3点交互式分配 |
| 购点法 | ✅ 27点，8-15范围 |
| 标准数组 | ✅ 紧凑布局，拖拽 |
| 最终属性 | 基础+背景，格式：17 (15+2) |
| PDF导出 | 格式正确，包含计算 |

---

## 🚨 如果仍有问题

### 方法1：完全重启
```bash
# 停止服务器
Ctrl+C

# 清除构建缓存
rm -rf .next

# 重新安装（可选）
npm install --cache ./.npm-cache --legacy-peer-deps

# 重启
npm run dev
```

### 方法2：检查浏览器控制台
1. 按 F12 打开开发者工具
2. 切换到"Console"标签
3. 查看是否有红色错误
4. 复制完整错误信息

### 方法3：检查终端输出
查看终端是否有编译错误：
```bash
✓ Compiled successfully  ← 应该看到这个
```

如果看到：
```bash
✗ Failed to compile
```
请复制完整错误信息。

---

## 📸 截图对照

### 正确的物种选择页面应该是：

```
选择物种

在 D&D 2024 版规则中，"种族"改为"物种"。每个物种都有独特的特质，不再提供固定属性加值。

💡 2024版变化：物种不再提供属性加值！属性加值现在来自背景（+3点）。

┌─────────────────────────────────────┐
│ 人类                               │
│ 多才多艺且富有适应力...             │
│ 体型：中型或小型（可选） 速度：30尺  │
│                                     │
│ 物种特质：                           │
│ • 足智多谋: 每次长休后获得英雄灵感    │
│ • 技艺娴熟: 获得一项任意技能的熟练    │
│ • 多才多艺: 获得一个起源专长...      │
└─────────────────────────────────────┘

┌─────────────────────────────────────┐
│ 精灵                               │
│ 精类生物，拥有敏锐感官和魔法天赋     │
│ ...                                │
└─────────────────────────────────────┘

... 总共10个物种
```

### 正确的购点法页面应该是：

```
分配属性

┌─────────────────┐
│ 标准数组 | 购点法(27点) | 手动输入
│         └──[选中]──┘
└─────────────────┘

已用点数: 15 / 27 | 剩余: 12

[力量]     [-]  12  [+]     调整值: +1
[敏捷]     [-]  10  [+]     调整值: +0
[体质]     [-]  13  [+]     调整值: +1
[智力]     [-]   8  [+]     调整值: -1
[感知]     [-]  10  [+]     调整值: +0
[魅力]     [-]  10  [+]     调整值: +0

成本表：
8→0 | 9→1 | 10→2 | 11→3 | 12→4 | 13→5 | 14→7 | 15→9
```

---

**祝测试顺利！** 🎲

如有任何问题，请提供：
1. 具体的错误信息（控制台或终端）
2. 操作步骤
3. 截图（如果可能）
